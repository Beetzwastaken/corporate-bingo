import{d as J,p as Y,j as K,c as Z,a as e,u as _,s as Q,b as V}from"./index-C6g-kKW7.js";import{c as ee,r as h}from"./store-D9DoIlTN.js";import"./vendor-gH-7aFTg.js";const se=a=>{const l=a==="single"?"MTG":"TEAM",t=Math.random().toString(36).substring(2,6).toUpperCase();return`${l}-${t}`},te=a=>a.roomType!=="single"||!a.expiresAt?!1:new Date>a.expiresAt,ae=a=>{if(a.roomType==="persistent")return!1;const l=new Date(Date.now()-7200*1e3);return a.lastActivity<l},re=ee()(J(Y((a,l)=>({rooms:{},activeRoomCode:null,currentPlayer:null,createRoom:async(t,c,s)=>{try{const n=se(s),d=await Z(t,c,s);if(!d.success||!d.data)return{success:!1,error:d.error||"Failed to create room"};const r=new Date,i={id:d.data.playerId,name:c,isHost:d.data.isHost,isConnected:!0,joinedAt:Date.now()},m={id:d.data.playerId,name:t,code:d.data.roomCode||n,players:[i],isActive:!0,createdAt:r,lastActivity:r,roomType:s,maxPlayers:10,expiresAt:s==="single"?new Date(r.getTime()+1440*60*1e3):void 0,cumulativeScores:s==="persistent"?{}:void 0,weeklyLeaderboard:s==="persistent"?[]:void 0,monthlyLeaderboard:s==="persistent"?[]:void 0},x={room:m,gameState:{board:[],markedSquares:Array(25).fill(!1),hasWon:!1,winningPattern:void 0},isActive:!0,lastSync:r};return a(p=>({rooms:{...p.rooms,[m.code]:x},activeRoomCode:m.code,currentPlayer:i})),{success:!0,roomCode:m.code}}catch(n){return console.error("Create room error:",n),{success:!1,error:n instanceof Error?n.message:"Failed to create room"}}},joinRoom:async(t,c)=>{try{const s=await K(t,c);if(!s.success||!s.data)return{success:!1,error:s.error||"Failed to join room"};const n=new Date,d={id:s.data.playerId,name:c,isHost:!1,isConnected:!0,joinedAt:Date.now()},r=t.startsWith("MTG-")?"single":"persistent",m={room:{id:t,name:s.data.roomName,code:t,players:[d],isActive:!0,createdAt:n,lastActivity:n,roomType:r,maxPlayers:10,expiresAt:r==="single"?new Date(n.getTime()+1440*60*1e3):void 0,cumulativeScores:r==="persistent"?{}:void 0,weeklyLeaderboard:r==="persistent"?[]:void 0,monthlyLeaderboard:r==="persistent"?[]:void 0},gameState:{board:[],markedSquares:Array(25).fill(!1),hasWon:!1,winningPattern:void 0},isActive:!0,lastSync:n};return a(x=>({rooms:{...x.rooms,[t]:m},activeRoomCode:t,currentPlayer:x.currentPlayer||d})),{success:!0}}catch(s){return console.error("Join room error:",s),{success:!1,error:s instanceof Error?s.message:"Failed to join room"}}},leaveRoom:t=>{a(c=>{const{[t]:s,...n}=c.rooms,d=c.activeRoomCode===t?Object.keys(n)[0]||null:c.activeRoomCode;return{rooms:n,activeRoomCode:d}})},leaveAllRooms:()=>{a({rooms:{},activeRoomCode:null})},setActiveRoom:t=>{const c=l();t&&c.rooms[t]?a({activeRoomCode:t}):a({activeRoomCode:null})},updateRoomState:(t,c)=>{a(s=>s.rooms[t]?{rooms:{...s.rooms,[t]:{...s.rooms[t],...c,room:{...s.rooms[t].room,...c.room||{},lastActivity:new Date}}}}:s)},updateRoomPlayers:(t,c)=>{a(s=>s.rooms[t]?{rooms:{...s.rooms,[t]:{...s.rooms[t],room:{...s.rooms[t].room,players:c,lastActivity:new Date}}}}:s)},updateGameState:(t,c)=>{a(s=>s.rooms[t]?{rooms:{...s.rooms,[t]:{...s.rooms[t],gameState:c,room:{...s.rooms[t].room,lastActivity:new Date}}}}:s)},updateCumulativeScores:(t,c,s)=>{a(n=>{if(!n.rooms[t]||n.rooms[t].room.roomType!=="persistent")return n;const d=n.rooms[t].room,r=d.cumulativeScores||{},i={...r,[c]:(r[c]||0)+s};return{rooms:{...n.rooms,[t]:{...n.rooms[t],room:{...d,cumulativeScores:i,lastActivity:new Date}}}}})},cleanupExpiredRooms:()=>{a(t=>{const c={};let s=t.activeRoomCode;return Object.entries(t.rooms).forEach(([n,d])=>{const{room:r}=d;!te(r)&&!ae(r)?c[n]=d:s===n&&(s=null)}),!s&&Object.keys(c).length>0&&(s=Object.keys(c)[0]),{rooms:c,activeRoomCode:s}})},getRoomsOfType:t=>{const c=l();return Object.values(c.rooms).filter(s=>s.room.roomType===t)},getActiveRoom:()=>{const t=l();return t.activeRoomCode&&t.rooms[t.activeRoomCode]||null},setCurrentPlayer:t=>{a({currentPlayer:t})}}),{name:"multi-room-storage",partialize:a=>({rooms:a.rooms,activeRoomCode:a.activeRoomCode,currentPlayer:a.currentPlayer}),onRehydrateStorage:()=>a=>{a?.rooms&&Object.values(a.rooms).forEach(l=>{l.room.createdAt&&typeof l.room.createdAt=="string"&&(l.room.createdAt=new Date(l.room.createdAt)),l.room.lastActivity&&typeof l.room.lastActivity=="string"&&(l.room.lastActivity=new Date(l.room.lastActivity)),l.room.expiresAt&&typeof l.room.expiresAt=="string"&&(l.room.expiresAt=new Date(l.room.expiresAt)),l.lastSync&&typeof l.lastSync=="string"&&(l.lastSync=new Date(l.lastSync))})}})));function D({player:a,className:l="",size:t="medium"}){const[c,s]=h.useState([]),[n,d]=h.useState(a.currentScore||0);h.useEffect(()=>{const m=a.currentScore||0,x=m-n;if(x!==0&&n!==void 0){const p={id:Date.now().toString(),points:x,type:x>0?"positive":"negative",timestamp:Date.now()};s(v=>[...v,p]),setTimeout(()=>{s(v=>v.filter(w=>w.id!==p.id))},2e3)}d(m)},[a.currentScore,n]);const r={small:"text-sm",medium:"text-base",large:"text-lg"},i=a.currentScore||0;return e.jsxs("div",{className:`relative inline-flex items-center space-x-2 ${l}`,children:[e.jsx("div",{className:`font-semibold ${r[t]} ${i>0?"text-cyan-400":"text-apple-secondary"}`,children:i}),e.jsx("div",{className:"absolute left-full ml-2 pointer-events-none",children:c.map(m=>e.jsxs("div",{className:`absolute whitespace-nowrap font-bold text-sm ${m.type==="positive"?"text-cyan-400":"text-red-400"} animate-score-float`,style:{animation:"scoreFloat 2s ease-out forwards",top:`${(c.length-c.indexOf(m)-1)*20}px`},children:[m.type==="positive"?"+":"",m.points]},m.id))})]})}function ne({players:a,currentPlayerId:l,className:t="",compact:c=!1}){const s=h.useMemo(()=>[...a].sort((r,i)=>{const m=r.currentScore||0,x=i.currentScore||0;return m!==x?x-m:r.name.localeCompare(i.name)}),[a]),n=s.length>0&&s[0].currentScore||0,d=s.filter(r=>(r.currentScore||0)===n&&n>0);return a.length===0?e.jsxs("div",{className:`apple-panel p-4 ${t}`,children:[e.jsx("h3",{className:"text-sm font-medium text-apple-secondary mb-2",children:"Leaderboard"}),e.jsx("p",{className:"text-xs text-apple-tertiary",children:"No players yet"})]}):c?e.jsxs("div",{className:`space-y-2 ${t}`,children:[e.jsxs("h3",{className:"text-sm font-medium text-apple-secondary mb-2",children:["Leaderboard (",a.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[s.slice(0,5).map((r,i)=>{const m=d.some(p=>p.id===r.id),x=r.id===l;return e.jsxs("div",{className:`flex items-center justify-between px-3 py-2 rounded-lg text-sm ${x?"bg-apple-accent/20 border border-apple-accent/30":"bg-apple-darkest"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[e.jsxs("span",{className:`text-xs font-medium w-6 text-center ${i<3?"text-yellow-400":"text-apple-secondary"}`,children:["#",i+1]}),m&&e.jsx("span",{className:"text-yellow-400 text-sm crown-animate",title:"Current Leader",children:"üëë"}),e.jsx("span",{className:`font-medium truncate ${x?"text-apple-accent":"text-apple-text"}`,children:r.name}),x&&e.jsx("span",{className:"text-xs text-apple-accent",children:"(You)"})]}),e.jsx(D,{player:r,size:"small"})]},r.id)}),s.length>5&&e.jsxs("div",{className:"text-xs text-apple-tertiary text-center pt-1",children:["+",s.length-5," more players"]})]})]}):e.jsxs("div",{className:`apple-panel p-6 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-apple-text",children:"Leaderboard"}),e.jsxs("span",{className:"text-sm text-apple-secondary",children:[a.length," ",a.length===1?"Player":"Players"]})]}),e.jsx("div",{className:"space-y-3",children:s.map((r,i)=>{const m=d.some(p=>p.id===r.id),x=r.id===l;return e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg transition-colors ${x?"bg-apple-accent/20 border border-apple-accent/30":"bg-apple-darkest hover:bg-apple-hover"}`,children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full font-bold text-sm ${i===0?"bg-yellow-500 text-black":i===1?"bg-gray-400 text-black":i===2?"bg-amber-600 text-black":"bg-apple-border text-apple-text"}`,children:i+1}),m&&e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-xl crown-animate",title:"Current Leader",children:"üëë"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`font-semibold truncate ${x?"text-apple-accent":"text-apple-text"}`,children:r.name}),r.isHost&&e.jsx("span",{className:"text-yellow-400 text-xs font-medium px-2 py-1 bg-yellow-900/20 rounded-full",children:"Host"}),x&&e.jsx("span",{className:"text-apple-accent text-xs font-medium px-2 py-1 bg-apple-accent/20 rounded-full",children:"You"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r.isConnected?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-xs text-apple-secondary",children:r.isConnected?"Online":"Offline"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{player:r,size:"large"}),e.jsx("span",{className:"text-xs text-apple-secondary",children:"pts"})]})]},r.id)})}),n>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-apple-border",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-apple-secondary",children:[e.jsx("span",{children:"Game Progress"}),e.jsxs("span",{children:[n," points to lead"]})]}),e.jsx("div",{className:"mt-2 bg-apple-darker rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-cyan-400 transition-all duration-500",style:{width:`${Math.min(n/200*100,100)}%`}})})]})]})}const X=a=>a==="single"?"‚è±Ô∏è":"‚ôæÔ∏è",O=a=>a==="single"?"text-blue-400":"text-green-400",le=(a,l=12)=>a.length>l?`${a.substring(0,l)}...`:a;function oe({rooms:a,activeRoomCode:l,onRoomChange:t,onRoomClose:c}){const s=Object.entries(a);return s.length===0?null:s.length===1?e.jsx("div",{className:"border-b border-apple-border bg-apple-darkest",children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-sm ${O(s[0][1].room.roomType)}`,children:X(s[0][1].room.roomType)}),e.jsx("span",{className:"text-sm font-medium text-apple-text",children:s[0][1].room.name}),e.jsx("span",{className:"text-xs text-apple-secondary font-mono bg-apple-darkest px-2 py-1 rounded",children:s[0][1].room.code})]})})}):e.jsxs("div",{className:"border-b border-apple-border bg-apple-darkest",children:[e.jsxs("div",{className:"flex overflow-x-auto scrollbar-hide",children:[s.map(([n,d])=>{const r=l===n,{room:i}=d;return e.jsxs("div",{className:`
                group relative flex items-center space-x-2 px-4 py-3 cursor-pointer
                border-b-2 transition-all duration-200 flex-shrink-0 min-w-0
                ${r?"border-apple-accent bg-apple-accent/5":"border-transparent hover:bg-apple-darkest/80"}
              `,onClick:()=>t(n),children:[e.jsx("span",{className:`text-sm flex-shrink-0 ${O(i.roomType)}`,children:X(i.roomType)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`text-sm font-medium truncate ${r?"text-apple-accent":"text-apple-text"}`,children:[e.jsx("span",{className:"hidden sm:inline",children:i.name}),e.jsx("span",{className:"sm:hidden",children:le(i.name)})]}),e.jsx("span",{className:`text-xs font-mono px-2 py-1 rounded flex-shrink-0 ${r?"bg-apple-accent/20 text-apple-accent":"bg-apple-darkest text-apple-secondary"}`,children:i.code})]}),e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[e.jsx("div",{className:`w-1 h-1 rounded-full ${i.players.some(m=>m.isConnected)?"bg-green-400":"bg-apple-secondary"}`}),e.jsxs("span",{className:"text-xs text-apple-secondary",children:[i.players.length," player",i.players.length!==1?"s":""]})]})]}),e.jsx("button",{onClick:m=>{m.stopPropagation(),c(n)},className:`
                  w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0
                  transition-all duration-200 opacity-0 group-hover:opacity-100
                  hover:bg-red-500/20 hover:text-red-400
                  ${r?"opacity-100":""}
                `,title:"Leave room",children:e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),r&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-apple-accent"})]},n)}),e.jsx("div",{className:"flex-shrink-0 border-l border-apple-border/50",children:e.jsxs("button",{className:`
              h-full px-4 py-3 text-apple-secondary hover:text-apple-accent
              hover:bg-apple-darkest/80 transition-all duration-200
              flex items-center space-x-2
            `,title:"Create or join another room",onClick:()=>{},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{className:"text-sm font-medium hidden lg:inline",children:"Add Room"})]})})]}),e.jsx("div",{className:"sm:hidden flex justify-center py-1",children:e.jsx("div",{className:"flex space-x-1",children:s.map(([n])=>e.jsx("div",{className:`w-1 h-1 rounded-full transition-colors ${l===n?"bg-apple-accent":"bg-apple-border"}`},n))})})]})}function ce({selectedType:a,onTypeChange:l,disabled:t=!1}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-apple-secondary mb-2",children:"Room Type"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:`
            relative p-4 rounded-lg border cursor-pointer transition-all duration-200
            ${a==="single"?"border-apple-accent bg-apple-accent/10":"border-apple-border bg-apple-darkest hover:bg-apple-darkest/80"}
            ${t?"opacity-50 cursor-not-allowed":""}
          `,onClick:()=>!t&&l("single"),children:[e.jsx("div",{className:`
            absolute top-3 right-3 w-4 h-4 rounded-full border-2 transition-all
            ${a==="single"?"border-apple-accent bg-apple-accent":"border-apple-border bg-transparent"}
          `,children:a==="single"&&e.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50 transform"})}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500/20 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-lg",children:"‚è±Ô∏è"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-apple-text text-sm mb-1",children:"Single Meeting"}),e.jsx("p",{className:"text-xs text-apple-secondary leading-relaxed",children:"One-time use for specific meetings. Auto-expires after 24 hours or 2 hours of inactivity."}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-xs text-apple-secondary",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-500/20 rounded text-blue-400 font-mono",children:"MTG-XXXX"}),e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:"Perfect for one-off meetings"})]})]})]})]}),e.jsxs("div",{className:`
            relative p-4 rounded-lg border cursor-pointer transition-all duration-200
            ${a==="persistent"?"border-apple-accent bg-apple-accent/10":"border-apple-border bg-apple-darkest hover:bg-apple-darkest/80"}
            ${t?"opacity-50 cursor-not-allowed":""}
          `,onClick:()=>!t&&l("persistent"),children:[e.jsx("div",{className:`
            absolute top-3 right-3 w-4 h-4 rounded-full border-2 transition-all
            ${a==="persistent"?"border-apple-accent bg-apple-accent":"border-apple-border bg-transparent"}
          `,children:a==="persistent"&&e.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50 transform"})}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500/20 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-lg",children:"‚ôæÔ∏è"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-apple-text text-sm mb-1",children:"Persistent Team"}),e.jsx("p",{className:"text-xs text-apple-secondary leading-relaxed",children:"Long-running room for teams. Maintains cumulative scores and leaderboards over time."}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-xs text-apple-secondary",children:[e.jsx("span",{className:"px-2 py-1 bg-green-500/20 rounded text-green-400 font-mono",children:"TEAM-XXXX"}),e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:"Never expires"})]})]})]})]})]}),e.jsx("div",{className:"mt-3 p-3 bg-apple-darkest/50 rounded-lg",children:a==="single"?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"w-1 h-1 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-apple-secondary",children:"Room automatically expires after 24 hours or 2 hours of inactivity"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"w-1 h-1 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-apple-secondary",children:"Perfect for one-time meetings, workshops, or events"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"w-1 h-1 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-apple-secondary",children:"Scores reset with each new game session"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"w-1 h-1 bg-green-400 rounded-full"}),e.jsx("span",{className:"text-apple-secondary",children:"Room persists indefinitely with cumulative scoring"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"w-1 h-1 bg-green-400 rounded-full"}),e.jsx("span",{className:"text-apple-secondary",children:"Weekly and monthly leaderboards track long-term performance"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"w-1 h-1 bg-green-400 rounded-full"}),e.jsx("span",{className:"text-apple-secondary",children:"Ideal for teams, departments, or ongoing groups"})]})]})})]})}function xe(){const[a,l]=h.useState(""),[t,c]=h.useState(""),[s,n]=h.useState(""),[d,r]=h.useState("single"),[i,m]=h.useState(!1),[x,p]=h.useState(""),[v,w]=h.useState({}),{playerName:j,isConnecting:b,isConnected:R,connectionError:A,setPlayerName:G}=_(),{rooms:S,activeRoomCode:k,currentPlayer:g,createRoom:B,joinRoom:H,leaveRoom:C,setActiveRoom:I,getActiveRoom:F,cleanupExpiredRooms:$}=re(),u=F()?.room||null,N=Object.keys(S).length>0;h.useEffect(()=>{!s&&j&&n(j)},[j,s]),h.useEffect(()=>{const o=setInterval(()=>{$()},3e5);return()=>clearInterval(o)},[$]),h.useEffect(()=>{if(!u?.players)return;u.players.forEach(f=>{const U=f.currentScore||0,E=v[f.id]||0,y=U-E;if(y!==0&&E!==void 0&&v[f.id]!==void 0)if(f.id===g?.id){const W=q(y);Q(y,W)}else y>0&&V(`${f.name} scored ${y} points!`,void 0,"success")});const o={};u.players.forEach(f=>{o[f.id]=f.currentScore||0}),w(o)},[u?.players,g?.id,v]);const q=o=>o===10?"Square verified!":o===50?"3-in-a-row bonus!":o===100?"4-in-a-row bonus!":o===200?"BINGO achieved!":o===-50?"Self-claim penalty":o>0?`+${o} points earned`:`${o} points penalty`,z=o=>{const f=o.trim().toUpperCase();return/^[A-Z0-9]{6}$/.test(f)||/^(MTG|TEAM)-[A-Z0-9]{4}$/.test(f)},P=()=>{const o=s.trim();o.length>=2&&o.length<=30?(G(o),p("")):p("Name must be 2-30 characters")},T=async()=>{if(!a.trim()){p("Room name is required");return}if(!j){p("Set your name first");return}p("");const o=await B(a.trim(),j,d);o.success?(l(""),m(!1)):p(o.error||"Could not create room")},L=async()=>{if(!t.trim()){p("Room code is required");return}if(!z(t)){p("Code must be 6 characters or MTG-/TEAM- format");return}if(!j){p("Set your name first");return}p("");const o=await H(t.toUpperCase(),j);o.success?c(""):p(o.error||"Could not join room")},M=o=>{o?C(o):k&&C(k),p("")};return e.jsxs("div",{className:"flex flex-col h-full",children:[N&&e.jsx(oe,{rooms:S,activeRoomCode:k,onRoomChange:I,onRoomClose:M}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(x||A)&&e.jsx("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-red-500"}),e.jsx("p",{className:"text-red-300 text-sm font-medium",children:x||A})]})}),!j&&e.jsxs("div",{className:"apple-panel p-6 bg-yellow-900/10 border-yellow-500/30",children:[e.jsx("h2",{className:"text-lg font-semibold text-apple-text mb-3",children:"Player Setup"}),e.jsx("p",{className:"text-apple-secondary text-sm mb-4",children:"Set your name to continue"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",value:s,onChange:o=>n(o.target.value),className:"apple-input w-full",placeholder:"Your name",maxLength:30,onKeyPress:o=>o.key==="Enter"&&P()}),e.jsx("button",{onClick:P,disabled:!s.trim()||b,className:"apple-button w-full justify-center",children:"Set Name"})]})]}),u&&e.jsxs("div",{className:"apple-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-lg ${u.roomType==="single"?"text-blue-400":"text-green-400"}`,children:u.roomType==="single"?"‚è±Ô∏è":"‚ôæÔ∏è"}),e.jsx("h2",{className:"text-lg font-semibold text-apple-text",children:"Current Room"}),e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${u.roomType==="single"?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"}`,children:u.roomType==="single"?"Meeting":"Team"})]}),e.jsx("p",{className:"text-apple-accent font-medium text-lg",children:u.name}),u.roomType==="single"&&u.expiresAt&&e.jsxs("p",{className:"text-xs text-apple-secondary mt-1",children:["Expires: ",new Date(u.expiresAt).toLocaleDateString()," at"," ",new Date(u.expiresAt).toLocaleTimeString()]})]})}),e.jsx("button",{onClick:()=>M(),disabled:b,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-apple-darkest disabled:cursor-not-allowed text-white rounded-md font-medium transition-colors text-sm",children:"Leave"})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-apple-secondary",children:"Room Code"}),e.jsx("span",{className:"font-mono text-apple-accent bg-apple-darkest px-3 py-1 rounded-md text-base",children:u.code})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-apple-secondary",children:"Players"}),e.jsxs("span",{className:"text-apple-text",children:[u.players.length,"/",u.maxPlayers||10]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-apple-secondary",children:"Your Name"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-apple-text",children:g?.name}),g?.isHost&&e.jsx("span",{className:"text-yellow-400 text-xs",children:"(Host)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-apple-secondary",children:"Status"}),e.jsxs("div",{className:`flex items-center space-x-2 ${R?"text-green-400":"text-red-400"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${R?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-xs",children:R?"Connected":"Offline"})]})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-apple-border",children:e.jsx(ne,{players:u.players,currentPlayerId:g?.id,compact:!0})})]}),(!N||i)&&j&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"apple-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-apple-text",children:"Create Room"}),N&&e.jsx("button",{onClick:()=>m(!1),className:"text-apple-secondary hover:text-apple-text transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ce,{selectedType:d,onTypeChange:r,disabled:b}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-apple-secondary mb-2",children:"Room Name"}),e.jsx("input",{type:"text",value:a,onChange:o=>l(o.target.value),className:"apple-input w-full",placeholder:d==="single"?"Meeting name":"Team name",maxLength:50,disabled:b,onKeyPress:o=>o.key==="Enter"&&T()})]}),e.jsx("button",{onClick:T,disabled:!a.trim()||b,className:"apple-button w-full justify-center bg-emerald-600 hover:bg-emerald-700",children:`Create ${d==="single"?"Meeting":"Team"} Room`})]})]}),e.jsxs("div",{className:"apple-panel p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-apple-text mb-4",children:"Join Room"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-apple-secondary mb-2",children:"Room Code"}),e.jsx("input",{type:"text",value:t,onChange:o=>c(o.target.value.toUpperCase()),className:"apple-input w-full text-center font-mono tracking-wider text-lg",placeholder:"MTG-A1B2 or TEAM-C3D4",maxLength:9,disabled:b,onKeyPress:o=>o.key==="Enter"&&L()}),e.jsx("p",{className:"text-xs text-apple-secondary mt-1",children:"Enter a meeting code (MTG-XXXX) or team code (TEAM-XXXX)"})]}),e.jsx("button",{onClick:L,disabled:!t.trim()||b,className:"apple-button w-full justify-center",children:"Join Room"})]})]})]}),N&&!i&&j&&e.jsx("div",{className:"apple-panel p-4",children:e.jsxs("button",{onClick:()=>m(!0),className:"apple-button w-full justify-center bg-emerald-600 hover:bg-emerald-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create Another Room"]})}),!N&&e.jsxs("div",{className:"apple-panel p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-apple-text mb-4",children:"Game Features"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-apple-accent/20 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{className:"text-xl",children:"üéØ"})}),e.jsx("h3",{className:"font-medium text-apple-text text-sm mb-1",children:"Unique Boards"}),e.jsx("p",{className:"text-xs text-apple-secondary",children:"Unique cards for each player"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-apple-accent/20 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{className:"text-xl",children:"‚ö°"})}),e.jsx("h3",{className:"font-medium text-apple-text text-sm mb-1",children:"Real-time"}),e.jsx("p",{className:"text-xs text-apple-secondary",children:"Instant synchronization"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-apple-accent/20 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{className:"text-xl",children:"‚è±Ô∏è"})}),e.jsx("h3",{className:"font-medium text-apple-text text-sm mb-1",children:"Meeting Rooms"}),e.jsx("p",{className:"text-xs text-apple-secondary",children:"Auto-expire after meetings"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-apple-accent/20 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{className:"text-xl",children:"‚ôæÔ∏è"})}),e.jsx("h3",{className:"font-medium text-apple-text text-sm mb-1",children:"Team Rooms"}),e.jsx("p",{className:"text-xs text-apple-secondary",children:"Persistent with leaderboards"})]})]})]})]})]})}export{xe as RoomManager};
